<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="styles.css">
    <title>PMDB: Create-Song</title>

    <script>
        function makePostRequest() {
            event.preventDefault();

            //Create element containing data from form. Convert data into JSON string.
            const formContainer = document.getElementById('songForm');
            const formElem = new FormData(formContainer);
            const data = Object.fromEntries(formElem.entries());
            const jsonString = JSON.stringify(data);
            console.log(jsonString);

            const f1 = getElementById('title').value;
            const f2 = getElementById('artist').value;
            const f3 = getElementById('album').value;

            //Create POST request, sends server JSON string
            const xhttp = new XMLHttpRequest();
            //ADD SUBMIT URL
            xhttp.open("POST", "http://localhost:5000/addSong?&song_name=" + f1 + "&artist_name=" + f2 + "&album_name=" + f3, true);
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("feedback").innerHTML = this.responseText;
                }
            };
            xhttp.send(jsonString);
        }
        
    </script>
</head>

<body>

    <!-- Top nav bar -->
    <h1>Personalized Music Database: Create</h1>

    <div id="topnav">
        <a href="main.html">Home</a>
        <a href="create.html">Create</a>
        <a href="update.html">Update</a>
    </div>

    <hr />

    <!-- Create form: fields -->
    <form id="songForm" onsubmit="makePostRequest(); return false;">
        <label for="title">Title:  </label>
        <input type="text" id="title" name="title">
        <br/><br/>
        <label for="artist">Artist:  </label>
        <input type="text" id="artist" name="artist">
        <br/><br/>
        <label for="album">Album:  </label>
        <input type="text" id="album" name="album">
        <br/><br/>
        <label for="playlist">Playlist:  </label>
        <input type="text" id="playlist" name="playlist">
        <br/><br/><br/>
        <input type="submit" value="Submit">
    </form>

    <!-- Feedback from server if any -->
    <p id="feedback"></p>

</body>

</html>
